# 安装目录配置需求文档

## 功能概述
修改Claude Model Switcher的安装过程，使其直接安装到 `/root/claude-model-switcher` 目录，而不是默认的 `/root/.claude/claude-model-switcher`，以避免与Claude Code内部配置冲突。

## 1. 主要需求

### 1.1 安装目录配置
**用户故事**: 作为系统管理员，我希望在安装时直接指定Claude Model Switcher的安装目录为 `/root/claude-model-switcher`，以便避免与Claude Code的内部配置发生冲突。

**验收标准**:
1. [ECHO] 安装脚本必须支持自定义安装目录参数
2. [ECHO] 默认安装目录应该设置为 `/root/claude-model-switcher` 而不是 `/root/.claude/claude-model-switcher`
3. [ECHO] 安装过程必须在指定的目录中创建所有必要的文件和子目录
4. [UD] 当用户不指定安装目录时，系统应该使用 `/root/claude-model-switcher` 作为默认目录
5. [UD] 安装脚本应该验证目标目录的可用性和权限
6. [UD] 安装完成后，所有配置文件中的路径引用都应该指向正确的安装目录

### 1.2 配置文件初始化
**用户故事**: 作为开发者，我希望安装过程中所有配置文件都能正确初始化为新的安装目录路径，以确保系统功能正常。

**验收标准**:
1. [ECHO] 配置文件 `config/app.conf` 中的 `SWITCHER_DIR` 变量必须初始化为 `/root/claude-model-switcher`
2. [ECHO] 所有其他配置文件中的路径引用都必须基于新的安装目录
3. [UD] 安装过程中应该验证所有路径引用的正确性
4. [UD] 如果配置文件初始化失败，安装过程应该中止并提供详细的错误信息

### 1.3 安装过程安全
**用户故事**: 作为用户，我希望安装过程是安全的，不会与现有系统冲突或导致数据丢失。

**验收标准**:
1. [UD] 在安装前，系统应该检查目标目录是否已存在并提示用户
2. [UD] 如果目标目录已存在且有重要文件，系统应该询问用户是否继续
3. [UD] 安装过程应该具有原子性（要么完全成功，要么完全回滚）
4. [UD] 安装完成后，系统应该验证所有文件的完整性和可访问性

### 1.4 安装兼容性
**用户故事**: 作为用户，我希望新的安装目录配置能够与现有的Claude Code环境兼容，不会产生冲突。

**验收标准**:
1. [UD] 新的安装目录不应该干扰Claude Code的默认配置目录
2. [UD] 安装过程应该检查并避免与现有Claude Code组件的路径冲突
3. [UD] 系统应该提供清晰的文档说明新的目录结构
4. [UD] 安装脚本应该能够检测和处理潜在的冲突情况

## 2. 技术约束

1. 必须保持Bash/Zsh兼容性
2. 必须支持自定义安装目录参数
3. 必须提供详细的安装日志记录
4. 必须支持安装前的预检查（目录权限、磁盘空间等）

## 3. 非功能性需求

1. **性能**: 迁移过程应该在30秒内完成
2. **可靠性**: 迁移成功率应该达到99.9%
3. **可用性**: 迁移命令应该提供清晰的进度反馈
4. **安全性**: 迁移过程不应该暴露敏感信息如API密钥

## 4. 边缘情况处理

1. 目标目录 `/root/claude-model-switcher` 已存在且有内容
2. 权限不足无法创建 `/root` 目录下的文件
3. 磁盘空间不足
4. 安装过程中脚本执行权限问题
5. 配置文件模板初始化失败
